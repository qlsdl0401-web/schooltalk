<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ìŠ¤ì¿¨í†¡</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { margin:0; font-family:'Apple SD Gothic Neo',Arial,sans-serif; background:#f1f5f9; }
    header { background:#1e40af; color:#fff; padding:12px; display:flex; justify-content:space-around; }
    header button { background:none; border:none; color:#fff; font-weight:bold; cursor:pointer; }
    main { max-width:900px; margin:auto; padding:15px; }
    .card { background:#fff; padding:16px; border-radius:14px; margin-bottom:20px; box-shadow:0 4px 10px rgba(0,0,0,0.05); }
    h2 { margin-top:0; color:#1e3a8a; }
    input, select, textarea { width:100%; padding:9px; margin-top:6px; border-radius:8px; border:1px solid #cbd5e1; }
    .btn { margin-top:6px; padding:7px 12px; border-radius:8px; border:none; cursor:pointer; background:#2563eb; color:#fff; font-size:13px; }
    .btn.like { background:#ef4444; }
    .btn.delete { background:#6b7280; }
    .post { border-top:1px solid #e5e7eb; padding:10px 0; }
    .meta { font-size:12px; color:#64748b; }
    .comment { background:#f8fafc; padding:6px; border-radius:6px; margin-top:4px; font-size:12px; }
    .hidden { display:none; }
    @media (max-width:600px){ header{flex-direction:column;gap:6px;text-align:center;} }
  </style>
</head>
<body>

<header>
  <button onclick="showPage('login')">ë¡œê·¸ì¸</button>
  <button onclick="showPage('find')">í•™êµ ì„ íƒ</button>
  <button onclick="showPage('board')">ê²Œì‹œíŒ</button>
  <button onclick="showPage('best')">ë² ìŠ¤íŠ¸</button>
</header>

<main>

<div id="login" class="card">
  <h2>ğŸ” ë¡œê·¸ì¸</h2>
  <select id="role">
    <option value="student">í•™ìƒ</option>
    <option value="admin">ê´€ë¦¬ì</option>
  </select>
  <button class="btn" onclick="login()">ë¡œê·¸ì¸</button>
</div>

<div id="find" class="card hidden">
  <h2>ğŸ« ì§€ì—­ â†’ í•™êµ ì„ íƒ</h2>
  <select id="region" onchange="changeRegion()">
    <option value="ì„œìš¸">ì„œìš¸</option>
    <option value="ë¶€ì‚°">ë¶€ì‚°</option>
  </select>
  <select id="school" onchange="changeSchool()"></select>
</div>

<div id="board" class="card hidden">
  <h2 id="schoolTitle"></h2>
  <div class="meta" id="time"></div>

  <input id="title" placeholder="ì œëª©" />
  <textarea id="content" placeholder="ë‚´ìš©"></textarea>
  <button class="btn" onclick="addPost()">ê¸€ ì‘ì„±</button>

  <div id="posts"></div>
</div>

<div id="best" class="card hidden">
  <h2>ğŸ”¥ ë² ìŠ¤íŠ¸ ê²Œì‹œë¬¼</h2>
  <div id="bestPosts"></div>
</div>

</main>

<script>
  let role = 'student';
  let currentRegion = 'ì„œìš¸';
  let currentSchool = '';

  const schools = {
    ì„œìš¸:['ì„œìš¸ê³ ','ì„œìš¸ì¤‘'],
    ë¶€ì‚°:['ë™ë˜ê³ ','ì—¬ëª…ì¤‘']
  };

  let data = JSON.parse(localStorage.getItem('schoolTalk')) || {};

  function save(){ localStorage.setItem('schoolTalk', JSON.stringify(data)); }

  function showPage(p){ ['login','find','board','best'].forEach(x=>document.getElementById(x).classList.add('hidden')); document.getElementById(p).classList.remove('hidden'); if(p==='best')renderBest(); }

  function login(){ role=document.getElementById('role').value; alert(role==='admin'?'ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸':'í•™ìƒìœ¼ë¡œ ë¡œê·¸ì¸'); showPage('find'); }

  function changeRegion(){ currentRegion=region.value; school.innerHTML=''; schools[currentRegion].forEach(s=>school.innerHTML+=`<option value="${s}">${s}</option>`); changeSchool(); }

  function changeSchool(){ currentSchool=school.value; if(!data[currentSchool])data[currentSchool]=[]; schoolTitle.innerText=currentSchool+' ê²Œì‹œíŒ'; showPage('board'); renderPosts(); }

  function addPost(){ if(!title.value||!content.value)return alert('ì…ë ¥ í•„ìš”'); data[currentSchool].push({t:title.value,c:content.value,l:0,cm:[],d:new Date().toLocaleString()}); title.value=''; content.value=''; save(); renderPosts(); }

  function likePost(i){ data[currentSchool][i].l++; save(); renderPosts(); }
  function addComment(i){ const v=document.getElementById('c'+i).value; if(!v)return; data[currentSchool][i].cm.push(v); save(); renderPosts(); }
  function delPost(i){ if(role!=='admin')return; if(confirm('ì‚­ì œ?')){ data[currentSchool].splice(i,1); save(); renderPosts(); } }

  function renderPosts(){ posts.innerHTML=''; data[currentSchool].forEach((p,i)=>{ posts.innerHTML+=`<div class='post'><strong>${p.t}</strong><p>${p.c}</p><div class='meta'>ğŸ•’ ${p.d} Â· â¤ï¸ ${p.l}</div><button class='btn like' onclick='likePost(${i})'>ì¢‹ì•„ìš”</button>${role==='admin'?`<button class='btn delete' onclick='delPost(${i})'>ì‚­ì œ</button>`:''}<input id='c${i}' placeholder='ëŒ“ê¸€'><button class='btn' onclick='addComment(${i})'>ëŒ“ê¸€</button>${p.cm.map(x=>`<div class='comment'>ğŸ’¬ ${x}</div>`).join('')}</div>`; }); time.innerText='í˜„ì¬ ì‹œê°„: '+new Date().toLocaleString(); }

  function renderBest(){ let all=[]; Object.keys(data).forEach(s=>data[s].forEach(p=>all.push({...p,school:s}))); all.sort((a,b)=>b.l-a.l); bestPosts.innerHTML=''; all.forEach((p,i)=>bestPosts.innerHTML+=`<div class='post'>${i+1}ìœ„ Â· ${p.school}<br><strong>${p.t}</strong><div class='meta'>â¤ï¸ ${p.l}</div></div>`); }

  changeRegion(); showPage('login');
</script>

</body>
</html>

